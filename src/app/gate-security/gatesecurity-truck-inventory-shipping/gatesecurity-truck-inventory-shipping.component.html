<app-loader *ngIf="isLoading">
</app-loader>
<div class="container-fluid">
  <h6 class="manulal-plan-header">
    <b>Truck status > Truck Inventory > Shipping</b>
    <span class="pull-right refresh-span">
      <button class="theme-small-button" (click)="export()" matTooltip="Export to excel">
        <i class="fa fa-file-excel-o" aria-hidden="true"></i>
      </button>
      <button class="theme-small-button" (click)="refreshData()" matTooltip="Refresh">
        <i class="fa fa-repeat fa-2x" aria-hidden="true"></i>
      </button>
      <button class="theme-small-button" (click)="showFilter()" matTooltip="Filter">
        <i class="fa fa-filter fa-2x" aria-hidden="true"></i>
      </button>
    </span>
  </h6>
  <div class="clearfix"></div>
  <div class="manualplan-fields" *ngIf="isShow">
      <form (submit)="truckstatusIndetsFilter()">
    <div class="col-md-12 row">
      <div class="col-md-12 padding-right-40">
        <div class="row tab-loadslip-fields">
          <div class="col-md-6">
            <div class="row">
              <!--  -->
              <div class="col-md-2 pl-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput aria-label="Source" placeholder="Source"
                      (keyup)="getfilterDestination($event,'source',isIntransitTruck)" autocomplete="off"
                      [matAutocomplete]="sourceAutocomplete" [(ngModel)]="source" name="source" oninput="this.value = this.value.toUpperCase()">
                    <mat-autocomplete #sourceAutocomplete="matAutocomplete">
                      <mat-option *ngFor="let list of sourceList" [value]="list.value">
                        <span matTooltip={{list.description}}>{{list.value}} - ({{list.description}})</span>
                      </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                </div>
              </div>
              <!-- <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput aria-label="Destination" placeholder="Destination" (keyup)="getfilterDestination($event,'destination')" autocomplete="off"
                      [matAutocomplete]="destinationAutocomplete" [(ngModel)]="destination" name="destination">
                    <mat-autocomplete #destinationAutocomplete="matAutocomplete">
                      <mat-option *ngFor="let list of destinationList" [value]="list.value">
                        <span matTooltip={{list.description}}>{{list.value}} - ({{list.description}})</span>
                      </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                </div>
              </div> -->

              <div class="col-md-2 pr-0">
                <div class="form-group">
                  <mat-form-field class="example-full-width">
                    <input matInput placeholder="Destination" aria-label="State" [matAutocomplete]="statesAutocomplete"
                      [(ngModel)]="destination" name="destination" oninput="this.value = this.value.toUpperCase()"
                      (keyup)="getfilterDestination($event,'destination', !isIntransitTruck)">
                    <mat-autocomplete #statesAutocomplete="matAutocomplete">
                      <mat-option *ngFor="let list of destinationList" [value]="list.value"
                        (click)="setDestDescription(list.description)"
                        (onSelectionChange)="setDestDescription(list.description)">
                        <span>{{list.value}}</span>
                      </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-4 pr-0">
                <div class="form-group">
                  <mat-form-field class="example-full-width">
                    <input matInput placeholder="Destination Description" aria-label="destDisAutocomplete"
                      [matAutocomplete]="destDisAutocomplete" [(ngModel)]="destinationDesc" name="destDisAutocomplete"
                      (keyup)="getUserDestinationList($event)" oninput="this.value = this.value.toUpperCase()">
                    <mat-autocomplete #destDisAutocomplete="matAutocomplete">
                      <mat-option *ngFor="let list of descriptionList" [value]="list.description"
                        (click)="setDestination(list.value)" (onSelectionChange)="setDestination(list.value)">
                        <span>({{list.description}})</span>
                      </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-4 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <mat-select placeholder="Truck/Container Type" [(ngModel)]="truckType" name="truckType" multiple>
                      <!-- <mat-option [value]="">None</mat-option> -->
                      <mat-option *ngFor="let truck of truckList" [value]="truck.value"> {{truck.value}} </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-3 pr-0">
                <mat-form-field>
                  <input matInput [(ngModel)]="trckNumber" name="truck number" autocomplete="off"
                    placeholder="Truck Number" oninput="this.value = this.value.toUpperCase()">
                </mat-form-field>
              </div>
              <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput aria-label="transporter" placeholder="Transporter"
                      (keyup)="getfilterTransporter($event)" autocomplete="off"
                      [matAutocomplete]="transporterAutocomplete" [(ngModel)]="transporter" name="transporter" oninput="this.value = this.value.toUpperCase()">
                    <mat-autocomplete #transporterAutocomplete="matAutocomplete">
                      <mat-option *ngFor="let list of transporterList" [value]="list.value">
                        <span>{{list.value}}</span>
                      </mat-option>
                    </mat-autocomplete>
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 pr-0">
                <mat-form-field>
                  <input matInput aria-label="Country of Destination" placeholder="Country of Destination"
                    (keyup)="countryOfDestinationFilter($event,'destCountrySearch')" autocomplete="off"
                    [matAutocomplete]="dischargeAutocomplete" [(ngModel)]="destCountryName" name="destCountryName" oninput="this.value = this.value.toUpperCase()">
                  <mat-autocomplete #dischargeAutocomplete="matAutocomplete">
                    <mat-option *ngFor="let country of countryList" [value]="country.description">
                      <span matTooltip={{country.description}}>{{country.value}} - ({{country.description}})</span>
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
              </div>
              <div class="col-md-3">
                <mat-form-field>
                  <input matInput [(ngModel)]="shipmentId" name="shipment" autocomplete="off" placeholder="Shipment Id" oninput="this.value = this.value.toUpperCase()">
                </mat-form-field>
              </div>


            </div>
          </div>
        </div>
        <div class="row tab-loadslip-fields">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-3 pl-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput [(ngModel)]="indentId" name="indentid" placeholder="Indent Id" autocomplete="off" oninput="this.value = this.value.toUpperCase()">
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput [min]="minDate" placeholder="Gate In From Date" disabled
                      [matDatepicker]="gateInFromDatePicker" autocomplete="off" [(ngModel)]="gateInFromDate"
                      (dateChange)="addEvent('gateInDate', $event)" name="gateInToDate">
                    <mat-datepicker-toggle matSuffix [for]="gateInFromDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #gateInFromDatePicker disabled="false"></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 pr-0">
                <mat-form-field>
                  <input matInput [min]="gateInFromDate" placeholder="Gate In To Date" disabled
                    [matDatepicker]="gateInToDatePicker" autocomplete="off" [(ngModel)]="gateInToDate"
                    name="gateInToDate">
                  <mat-datepicker-toggle matSuffix [for]="gateInToDatePicker"></mat-datepicker-toggle>
                  <mat-datepicker #gateInToDatePicker [disabled]="!gateInFromDate"></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput [min]="minDate" placeholder="Rep From Date" disabled
                      [matDatepicker]="reportFromDatePicker" autocomplete="off" [(ngModel)]="reportFromDate"
                      (dateChange)="addEvent('repFromDate', $event)" name="reportfromDate">
                    <mat-datepicker-toggle matSuffix [for]="reportFromDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #reportFromDatePicker disabled="false"></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>

              <!-- <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput [min]="minDate" placeholder="Gate Out From Date" disabled [matDatepicker]="gateOutFromDatePicker"
                      autocomplete="off" [(ngModel)]="gateOutFromDate" (dateChange)="addEvent('gateOutDate', $event)"
                      name="gateoutFromDate">
                    <mat-datepicker-toggle matSuffix [for]="gateOutFromDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #gateOutFromDatePicker disabled="false"></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-3 pr-0">
                <mat-form-field>
                  <input matInput [min]="gateOutFromDate" placeholder="Gate Out To Date" disabled [matDatepicker]="gateOutToDatePicker"
                    autocomplete="off" [(ngModel)]="gateOutToDate" name="gateoutToDate">
                  <mat-datepicker-toggle matSuffix [for]="gateOutToDatePicker"></mat-datepicker-toggle>
                  <mat-datepicker #gateOutToDatePicker [disabled]="!gateOutFromDate"></mat-datepicker>
                </mat-form-field>
              </div> -->
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-3 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <input matInput [min]="reportFromDate" placeholder="Rep To Date" disabled
                      [matDatepicker]="reportToDatePicker" autocomplete="off" [(ngModel)]="reportToDate"
                      name="reportToDate">
                    <mat-datepicker-toggle matSuffix [for]="reportToDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #reportToDatePicker [disabled]="!reportFromDate"></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div class="col-md-2 pr-0">
                <mat-form-field>
                  <mat-select placeholder="Bay Status" [(ngModel)]="bayStatus" name="bayStatus" multiple>
                    <!-- <mat-option [value]="">None</mat-option> -->
                    <mat-option *ngFor="let item of baystatusList" [value]="item"> {{item}} </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-md-2 pr-0">
                <mat-form-field>
                  <mat-select placeholder="Select Status" name="status" autocomplete="off" [(ngModel)]="statusType" multiple>
                    <!-- <mat-option [value]="">None</mat-option> -->
                    <mat-option *ngFor="let status of reportTruckStatusList" [value]="status.value">
                      {{status.key}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-md-2 pr-0">
                <mat-form-field>
                  <mat-select placeholder="Rejection" [(ngModel)]="rejection" name="rejection" multiple>
                    <!-- <mat-option [value]="">None</mat-option> -->
                    <mat-option *ngFor="let item of rejectionList" [value]="item"> {{item}} </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-md-2 pr-0">
                <div class="form-group">
                  <mat-form-field>
                    <mat-select placeholder="Ind Cat" [(ngModel)]="materialGrp" name="materialGrp" multiple>
                      <mat-option *ngFor="let category of categoryList" [value]="category">{{category}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pull-right">
        <div class="search-fileds">
          <button class="theme-small-button" type="submit" matTooltip="Search">
            <i class="fa fa-search fa-2x" aria-hidden="true"></i>
          </button>
          <button class="theme-delete-button" type="button" (click)="clearData()" matTooltip="Clear All">
            <i class="fa fa-times" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>
      </form>
  </div>
  <!-- For FGS  Gate Security role Table-->
  <ngx-datatable class='material  ngx-table-custom-scroll ngx-table-tr-custom-scroll' #table
    [rows]='gateSeuReportedTrucksIndents' [columnMode]="'force'" [headerHeight]="50" [footerHeight]="30"
    [rowHeight]="'auto'" [limit]="page.limit" [scrollbarH]="true" [count]="page.count" [offset]="page.offset"
    [externalPaging]="true" (page)="GateSecurityDatatablePageData($event)" [selected]="selected"
    [selectionType]="'single'">
    <ngx-datatable-column name="Indent Id" [frozenLeft]="freezeLeftValue" [width]="180" [resizeable]="false" [sortable]="false"
      prop="indentId">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <!-- intransitTruck' --- Intransit trucks can't be edit  -->
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-indentId'] = true"
            *ngIf="!editing[rowIndex + '-indentId']">
            <span class="edit-label">{{row.indentId}}
            </span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-indentId']">
            <input class="table-input" [value]="row.indentId" (blur)="updateValue($event, 'indentId', rowIndex)" oninput="this.value = this.value.toUpperCase()">
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.indentId | uppercase}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column [frozenLeft]="true" name="Truck Number" [width]="120" [resizeable]="false" [sortable]="true"
      prop="truckNumber">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <!-- intransitTruck' --- Intransit trucks can't be edit  -->
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-truckNumber'] = true"
            *ngIf="!editing[rowIndex + '-truckNumber']">
            <span class="edit-label">{{row.truckNumber | uppercase}}
            </span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-truckNumber']">
            <input class="table-input" [value]="row.truckNumber" (blur)="updateValue($event, 'truckNumber', rowIndex)"
              (keypress)="helperService.alphaNumericOnly($event)" oninput="this.value = this.value.toUpperCase()">
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.truckNumber | uppercase}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Transporter" [frozenLeft]="true" [width]="100" [resizeable]="false" [sortable]="false"
      prop="transporter">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.transporter | uppercase}}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column [frozenLeft]="true" name="Destination" [width]="100" [resizeable]="false" [sortable]="false"
      prop="destination">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.destination}}
      </ng-template>
    </ngx-datatable-column>
    <!-- Edit destination -->
    <!-- <ngx-datatable-column  [frozenLeft]="true" name="Destination" [width]="100" [resizeable]="false" [sortable]="false" prop="destination">
      <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-row="row">
        <ng-container *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
            <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-destination'] = true"
              *ngIf="!editing[rowIndex + '-destination']">
              <span class="edit-label">{{row.destination}}
              </span>
              <i class="fa fa-pencil" aria-hidden="true"></i>
            </div>
            <mat-form-field class="example-full-width" *ngIf="editing[rowIndex+ '-destination']">
              <input matInput autofocus [matAutocomplete]="datatableDestIndentAutocomplete" 
                [value]="row.destination" autofocus (keyup)="getfilterDestination($event,'destination')">
              <mat-autocomplete #datatableDestIndentAutocomplete="matAutocomplete">
                <mat-option *ngFor="let list of destinationList" [value]="list.value" (click)="getIndentsFromDest(row,list)"
                        (onSelectionChange)="getIndentsFromDest(row,list)">
                  <span>{{list.value}}</span>
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
        </ng-container>
        <ng-container *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.destination}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column> -->
    <ngx-datatable-column name="Dest Description" [width]="130" [resizeable]="false" [sortable]="false" prop="destDis">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.destDis}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Truck Type" [width]="130" [resizeable]="false" [sortable]="true" prop="truckType">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-truckType'] = true"
            *ngIf="!editing[rowIndex + '-truckType']">
            <span class="edit-label">{{row.truckType}}
            </span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <mat-form-field *ngIf="editing[rowIndex+ '-truckType']">
            <mat-select autofocus placeholder="Truck Type" [ngModel]="row.truckType" name=truckType{rowIndex}
              (ngModelChange)="updateValue($event,'truckType',rowIndex)">
              <mat-option *ngFor="let truck of truckList" [value]="truck.value">
                {{truck.value}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.truckType | uppercase}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Report Date" [width]="130" [resizeable]="false" [sortable]="false" prop="reportedDate">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.reportedDate | customDateFormat | date:'dd-MMM-yyyy,HH:mm'}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Truck Status" [width]="80" [resizeable]="false" [sortable]="false" prop="status">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.status}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Bay Status" [width]="80" [resizeable]="false" [sortable]="false" prop="callStatus">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <ng-container *ngIf="(row.bayStatus != '')">
          <span [ngClass]="{'blink':((row.bayStatus == 'CALL') && (row.gateInDate == null))}">{{(row.bayStatus ==
            'CALL') ? ((row.gateInDate)? row.bayStatus:'Calling'):row.bayStatus}}</span>
        </ng-container>
        <ng-container *ngIf="(row.bayStatus == '' || row.bayStatus == null)">
          {{row.bayStatus}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="In weight (Kg)" [width]="80" [resizeable]="false" [sortable]="false" prop="inWeight">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <mat-form-field>
          <input matInput (blur)="updateValue($event, 'inWeight', rowIndex)" [value]="row.inWeight?row.inWeight:''"
            (keypress)="service.numberOnly($event)" autocomplete="off" />
        </mat-form-field>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="In weight Action" [width]="70" [resizeable]="false">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <button (click)="inweightUpdate(row)" class="theme-small-button" [ngClass]="(row.inWeightStatus)?'green':''"
          matTooltip="In Weight Update">
          <i class="fa fa-arrow-circle-o-right fa-2x" aria-hidden="true"></i>
        </button>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Gate In" [width]="130" [resizeable]="false" prop="gateIn">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <span *ngIf="row.gateIn">{{row.gateInDate | customDateFormat | date:'dd-MMM-yyyy,HH:mm'}}</span>
        <button mat-raised-button color="primary" *ngIf="!(row.gateIn)" (click)="gateInTruck(row,rowIndex)"
          class="table-btn">Gate
          In
        </button>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Out Weight (Kg)" [width]="80" [resizeable]="false" [sortable]="false" prop="outWeight">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <mat-form-field>
          <input matInput (blur)="updateValue($event, 'outWeight', rowIndex)" [value]="row.outWeight?row.outWeight:''"
            autocomplete="false" (keypress)="service.numberOnly($event)" />
        </mat-form-field>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Out weight Action" [width]="80" [resizeable]="false">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <button (click)="outWeightUpdate(row)" matTooltip="Out weight Update" class="theme-delete-button"
          [ngClass]="(row.outWeightStatus)?'red':''">
          <i class="fa fa-arrow-circle-left fa-2x" aria-hidden="true"></i>
        </button>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Net Weight (Kg)" [width]="80" [resizeable]="false" [sortable]="false" prop="netWeight">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.netWeight}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="SAP invoice weight(Kg)" [width]="100" [resizeable]="false" prop="dropSeq"
      [sortable]="true">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.sapInvWeight}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Weight Diff (Kg)" [width]="80" [resizeable]="false" [sortable]="true" prop="netWeight">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <span [ngClass]="(row.weightDiffStatus)?'text-danger':''">{{row.diffInvWeight}}</span>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Truck Capacity (Kg)" [width]="80" [resizeable]="false" [sortable]="false" prop="truckCapacity">
      <!-- <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <mat-form-field>
          <lable matInput (blur)="updateValue($event, 'truckCapacity', rowIndex)" [value]="row.truckCapacity?row.truckCapacity:''"
            autocomplete="false" (keypress)="service.numberOnly($event)" />
        </mat-form-field>
      </ng-template> -->
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.truckCapacity}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Gate Out" [width]="120" [resizeable]="false" prop="gateOut">
      <ng-template let-row="row" ngx-datatable-cell-template let-rowIndex="rowIndex">
        <span *ngIf="row.gateOut">{{row.gateOutDate | customDateFormat | date:'dd-MMM-yyyy,HH:mm'}}</span>
        <!-- First button visible only On GatedIn not reject for captcure the Gateout commnts -->
        <!-- <button mat-raised-button color="primary"
          *ngIf="!(row.gateOut) && (row.status == 'GATED_IN') && (row.rejectionStatus !=='REJECTED') "
          (click)="gateoutModal(row,rowIndex)" class="table-btn">Gate
          Out
        </button> -->
        <button mat-raised-button color="primary"
          *ngIf="!(row.gateOut) && (row.status == 'GATED_IN') && (row.rejectionStatus !=='REJECTED') "
          (click)="gateoutWithoutLSModal(row,rowIndex)" class="table-btn">Gate
          Out
        </button>
        <button mat-raised-button color="primary"
          *ngIf="!(row.gateOut) && ((row.status !== 'GATED_IN') || (row.rejectionStatus =='REJECTED'))"
          (click)="gateOutTruck(row,rowIndex)" class="table-btn">Gate
          Out
        </button>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Loadslip Comments" [width]="100" [resizeable]="false" [sortable]="true"
      prop="loadslipComments">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <div [title]="row.loadslipComments" (click)="showLoadslipComments(row.loadslipComments)"
          [ngClass]="{'cursor-pointer':row.loadslipComments?.length>9}" *ngIf="(row.loadslipComments)">
          {{(row.loadslipComments?.length>9) ? (row.loadslipComments | slice:0:9)+'..':(row.loadslipComments)}}
        </div>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Gate Comments" [width]="100" [resizeable]="false" prop="comments" [sortable]="true">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <div class="edit-field" [title]="row.comments">
          <span class="edit-label">{{ (row.comments?.length>9)? (row.comments | slice:0:9)+'..':(row.comments)}}
          </span>
          <i class="fa fa-pencil" aria-hidden="true" (click)="showComments(row.comments,row)"></i>
        </div>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Rejection" [width]="80" [resizeable]="false" [sortable]="false" prop="rejectionStatus">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.rejectionStatus}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Rejection Desc" [width]="100" [resizeable]="false" [sortable]="false"
      prop="rejectionDesc">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.rejectionDesc}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Action" [width]="410" [resizeable]="false">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <button mat-raised-button color="primary"
          [disabled]="(((row.status!='GATED_IN')&&(row.status!='REPORTED')) || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck))"
          (click)="saveTruck(row)" class="table-btn mr-10">Save Truck
        </button>
        <button mat-raised-button color="primary" *ngIf="(row.status=='REPORTED')"
          [disabled]="row.rejectionStatus == 'REJECTED'" (click)="openTruckModel(row,rowIndex)"
          class="table-btn mr-10">Reject Truck
        </button>
        <ng-container>
          <button mat-raised-button color="primary" [disabled]="!row.shipmentId"
            (click)="viewLoadslip(row.shipmentId,'loadslipView')" class="table-btn mr-10">View
            Loadslips
          </button>
          <button mat-raised-button color="primary" [disabled]="!row.shipmentId"
            (click)="viewLoadslip(row.shipmentId,'invoiceView')" class="table-btn">LoadSlip
            Invoice
          </button>
        </ng-container>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Driver Name" [width]="100" [resizeable]="false" [sortable]="true" prop="driverName">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-driverName'] = true"
            *ngIf="!editing[rowIndex + '-driverName']">
            <span class="edit-label">{{row.driverName}}
            </span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <mat-form-field *ngIf="editing[rowIndex+ '-driverName']">
            <input matInput [value]="row.driverName" (blur)="updateValue($event, 'driverName', rowIndex)"
              oninput="this.value = this.value.toUpperCase()">
          </mat-form-field>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.driverName}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Driver Number" [width]="100" [resizeable]="false" [sortable]="true"
      prop="driverContact">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-driverContact'] = true"
            *ngIf="!editing[rowIndex + '-driverContact']">
            <span class="edit-label">{{row.driverContact}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <mat-form-field *ngIf="editing[rowIndex+ '-driverContact']">
            <input matInput [value]="row.driverContact" (keypress)="service.numberOnly($event)"
              (keypress)="helperService.numericOnly($event)" (blur)="updateValue($event, 'driverContact', rowIndex)">
          </mat-form-field>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.driverContact}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Driver Licence" [width]="100" [resizeable]="false" [sortable]="true"
      prop="driverLicense">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-driverLicense'] = true"
            *ngIf="!editing[rowIndex + '-driverLicense']">
            <span class="edit-label">{{row.driverLicense}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <mat-form-field *ngIf="editing[rowIndex+ '-driverLicense']">
            <input matInput [value]="row.driverLicense" (blur)="updateValue($event, 'driverLicense', rowIndex)"
              oninput="this.value = this.value.toUpperCase()">
          </mat-form-field>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.driverLicense}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Driver Consent Status" [width]="100" [resizeable]="false" [sortable]="true" prop="trackingConsentStatus">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.trackingConsentStatus}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Telecom Service Provider" [width]="100" [resizeable]="false" [sortable]="true" prop="consentPhoneTelecom">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.consentPhoneTelecom | uppercase}}
      </ng-template>
    </ngx-datatable-column>
    
    <ngx-datatable-column name="Initiate Consent" [width]="160" [resizeable]="false" [sortable]="true" prop="action">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <ng-container>
         
            <button mat-raised-button color="primary" *ngIf="(row.trackingConsentStatus!='Success' || row.trackingConsentStatus!=null)"
            [disabled]="row.trackingConsentStatus == 'Success'" (click)="checkConsent(row)"
            class="table-btn mr-10">Check Consent Status
          </button>
          
        </ng-container>
      </ng-template>
    </ngx-datatable-column>


    <ngx-datatable-column name="ShipmentId" [width]="130" [resizeable]="false" [sortable]="false" prop="shipmentId">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.shipmentId | uppercase}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Container" [width]="120" [resizeable]="false" [sortable]="true" prop="containerNum">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-containerNum'] = true"
            *ngIf="!editing[rowIndex + '-containerNum']">
            <span class="edit-label">{{row.containerNum | uppercase}}
            </span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <mat-form-field *ngIf="editing[rowIndex+ '-containerNum']">
            <input matInput [value]="row.containerNum" (blur)="updateValue($event, 'containerNum', rowIndex)"
              (keypress)="helperService.alphaNumericOnly($event)" oninput="this.value = this.value.toUpperCase()">
          </mat-form-field>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{row.containerNum | uppercase}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Bay" [width]="40" [resizeable]="false" [sortable]="false" prop="bayAssigned">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.bayAssigned}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="SAP invoice value(INR)" [width]="90" [resizeable]="false" prop="dropSeq"
      [sortable]="true">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.sapInvValue}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Eway bill No" [width]="100" [resizeable]="false" prop="dropSeq" [sortable]="true">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.ewayBillNo}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Source" [width]="70" [resizeable]="false" [sortable]="false" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.source}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="LR Num" [width]="120" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.lrNum}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="LR Date" [width]="150" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.lrDate ? (row.lrDate | customDateFormat | date:'dd-MMM-yyyy') : '--'}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Indent Cat" [width]="120" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.indentCategory}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="SAP Invoice" [width]="120" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.sapInvoice}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot Tyre" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totTyre}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot Tube" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totTube}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot Flap" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totFlap }}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot Valve" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totValve}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot PCTR" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totPctr}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Other Qty" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.otherQty}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Tot Qty" [width]="70" [resizeable]="false" [sortable]="true" prop="source">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.totQty}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Country of Destination" [width]="150" [resizeable]="false" [sortable]="true"
      prop="destCountryName">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.destCountryName}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Gate Serial No" [width]="120" [resizeable]="false" [sortable]="true"
      prop="gateControlCode">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.gateControlCode}}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="PUC" [width]="127" [resizeable]="false" [sortable]="true" prop="puc">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-puc'] = true"
            *ngIf="!editing[rowIndex + '-puc']">
            <span class="edit-label">{{(row.puc)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-puc']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.puc" name=puc{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'puc', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.puc)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Insurance" [width]="127" [resizeable]="false" [sortable]="true" prop="insurance">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-insurance'] = true"
            *ngIf="!editing[rowIndex + '-insurance']">
            <span class="edit-label">{{(row.insurance)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-insurance']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.insurance" name=insurance{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'insurance', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.insurance)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Seat Belt" [width]="127" [resizeable]="false" [sortable]="true" prop="seatBelt">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-seatBelt'] = true"
            *ngIf="!editing[rowIndex + '-seatBelt']">
            <span class="edit-label">{{(row.seatBelt)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-seatBelt']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.seatBelt" name=seatBelt{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'seatBelt', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.seatBelt)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="First Aid" [width]="127" [resizeable]="false" [sortable]="true" prop="firstAid">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-firstAid'] = true"
            *ngIf="!editing[rowIndex + '-firstAid']">
            <span class="edit-label">{{(row.firstAid)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-firstAid']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.firstAid" name=firstAid{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'firstAid', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.firstAid)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Fire Extenguisher" [width]="127" [resizeable]="false" [sortable]="true"
      prop="fireExtenguisher">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit"
            (click)="editing[rowIndex + '-fireExtenguisher'] = true"
            *ngIf="!editing[rowIndex + '-fireExtenguisher']">
            <span class="edit-label">{{(row.fireExtenguisher)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-fireExtenguisher']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.fireExtenguisher" name=fireExtenguisher{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'fireExtenguisher', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.fireExtenguisher)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Emergency Card" [width]="127" [resizeable]="false" [sortable]="true"
      prop="emergencyCard">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-emergencyCard'] = true"
            *ngIf="!editing[rowIndex + '-emergencyCard']">
            <span class="edit-label">{{(row.emergencyCard)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-emergencyCard']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.emergencyCard" name=emergencyCard{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'emergencyCard', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.emergencyCard)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Spark Arrestor" [width]="127" [resizeable]="false" [sortable]="true"
      prop="sparKArrestor">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-sparKArrestor'] = true"
            *ngIf="!editing[rowIndex + '-sparKArrestor']">
            <span class="edit-label">{{(row.sparKArrestor)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-sparKArrestor']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.sparKArrestor" name=sparKArrestor{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'sparKArrestor', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.sparKArrestor)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Fitness Certificate" [width]="127" [resizeable]="false" [sortable]="true"
      prop="fitnessCert">
      <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
        <ng-container
          *ngIf="(row.status === 'GATED_IN' || row.status == 'REPORTED') && (row.rejectionStatus != 'REJECTED') && (!row.intransitTruck)">
          <div class="edit-field" title="Double click to edit" (click)="editing[rowIndex + '-fitnessCert'] = true"
            *ngIf="!editing[rowIndex + '-fitnessCert']">
            <span class="edit-label">{{(row.fitnessCert)?'Yes':'No'}}</span>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </div>
          <div *ngIf="editing[rowIndex+ '-fitnessCert']" class="custom-table-radio-buttons">
            <mat-radio-group [(ngModel)]="row.fitnessCert" name=fitnessCert{{rowIndex}}>
              <mat-radio-button class="example-radio-button" *ngFor="let item of items" [value]="item.value"
                (change)="updateValue($event, 'fitnessCert', rowIndex)">
                {{item.key}}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </ng-container>
        <ng-container
          *ngIf="(row.status !== 'GATED_IN' && row.status !== 'REPORTED') || (row.rejectionStatus == 'REJECTED') || (row.intransitTruck)">
          {{(row.fitnessCert)?'Yes':'No'}}
        </ng-container>
      </ng-template>
    </ngx-datatable-column>
  
  <ngx-datatable-column name="Fuel Type" [width]="90" [resizeable]="false" [sortable]="true" prop="fuelType">
    <ng-template let-row="row" ngx-datatable-cell-template>
      {{row.fuelType}}
    </ng-template>
  </ngx-datatable-column><ngx-datatable-column name="BS Norms" [width]="90" [resizeable]="false" [sortable]="true" prop="updateUser">
    <ng-template let-row="row" ngx-datatable-cell-template>
      {{row.bsNorms}}
    </ng-template>
  </ngx-datatable-column>
    <ngx-datatable-column name="Insert User" [width]="90" [resizeable]="false" [sortable]="true" prop="insertUser">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.insertUser}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Update User" [width]="90" [resizeable]="false" [sortable]="true" prop="updateUser">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.updateUser}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Upload Photo" [width]="90" [resizeable]="false" [sortable]="true" prop="uploadPhoto">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <input #file type="file" [hidden]="true" accept="image/*" (change)="onFileChange($event,row.shipmentId,row.truckNumber)">
        <button mat-button #upload (click)="file.click()">Upload file</button>
      </ng-template>
    </ngx-datatable-column>
    
    <!-- Footer Template starts -->
    <ngx-datatable-footer>
      <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="pageSize"
        let-selectedCount="selectedCount" let-curPage="curPage" let-offset="offset" let-isVisible="isVisible">
        <div class="page-count">
          <span *ngIf="selectedCount">
            {{selectedCount.toLocaleString()}} Selected |
          </span>
          Showing {{(offset * pageSize)+1}} to {{(rowCount>
          (curPage*pageSize))?(curPage*pageSize):(rowCount)}} of
          {{(rowCount)}} records.
        </div>
        <datatable-pager [pagerLeftArrowIcon]="'datatable-icon-left'" [pagerRightArrowIcon]="'datatable-icon-right'"
          [pagerPreviousIcon]="'datatable-icon-prev'" [pagerNextIcon]="'datatable-icon-skip'" [page]="curPage"
          [size]="pageSize" [count]="rowCount" [hidden]="!((rowCount / pageSize) > 1)"
          (change)="table.onFooterPage($event)">
        </datatable-pager>
      </ng-template>
    </ngx-datatable-footer>
    <!-- Footer Template Ends -->
  </ngx-datatable>
</div>

<!-- View Loadslips  for coorsponding shipment -->
<div class="modal" id="loadslipsModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Loadslip List</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <ul>
          <li *ngFor="let item of loadslipList;let i=index">
            <span>
              {{i+1}})
              <span class="link" style="margin-left: 10px;margin-right: 50px"
                (click)="viewLoadslipnavigation(item)">{{item.loadlipId}}
              </span>
              <span>
                {{item.type}}
              </span>
            </span>
          </li>
        </ul>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>


<!--  -->
<div class="modal" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <form name="form" #f="ngForm">
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Truck Inventory Comments</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <!-- Modal body -->
        <div class="modal-body">
          <div class="form-group">
            <mat-form-field appearance="standard" class="example-full-width">
              <input matInput placeholder="Comments" aria-label="State" [(ngModel)]="truckComments" name="Comments"
                #comments="ngModel" autocomplete="off">
              <!-- <mat-error *ngIf="(f.submitted && comments.invalid)">
                <p *ngIf="comments.errors.required">Comment is
                  <strong>required</strong>
                </p>
              </mat-error> -->
            </mat-form-field>
          </div>
        </div>
        <!-- Modal footer -->
        <div class="modal-footer">
          <!-- <button type="button" class="btn btn-danger" >Close</button> -->
          <button type="submit" mat-raised-button color="primary" (click)="save(f)">Save</button>
          <button type="button" mat-raised-button class="mat-default" color="default"
            data-dismiss="modal">Close</button>
        </div>
      </form>
    </div>
  </div>
</div>


<div class="modal" id="rejectionModel">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Reject Reason</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <div class="form-group">
          <mat-form-field class="example-full-width">
            <mat-select placeholder="Reject reasons" [(ngModel)]="rejectReason" name="rejectReason">
              <mat-option *ngFor="let reason of rejectRasonList" [value]="reason.rejectionCode">
                {{reason.rejectionCode}}-{{reason.rejectionDesc}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" mat-raised-button color="primary" (click)="rejectTruck(rejectReason)">Submit</button>
      </div>
    </div>
  </div>
</div>
<!-- View Loadslips  for coorsponding shipment -->
<div class="modal" id="commentModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">loadslip-Comments</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <p>{{loadslipComments}}</p>
      </div>
      <!-- Modal footer -->
    </div>
  </div>
</div>




<div class="modal fade" id="gateOutRejectionModal" back-drop="static" key-board="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Gateout Reason</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <div class="form-group">
          <mat-form-field class="example-full-width">
            <mat-select placeholder="Gateout reasons" [(ngModel)]="gateoutReason" name="gateoutReason">
              <mat-option *ngFor="let reason of rejectRasonList" [value]="reason.rejectionCode">
                {{reason.rejectionCode}}-{{reason.rejectionDesc}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" mat-raised-button color="primary" (click)="gateOutReason(gateoutReason)">Submit</button>
      </div>
    </div>
  </div>
</div>

<!-- Displaying the Warning message when Gate security tries to Gate_Out the truck Without LS -->
<div class="modal fade" id="gateoutWithoutLSModal" back-drop="static" key-board="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" style="color: red;">Warning</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body" style="text-align: center;">
        <b >Truck can be Gated Out only when FGS Rejects it. </b>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

<!-- Indent List Modal -->
<div class="modal fade" id="destIndentModal" back-drop="static" key-board="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Indents</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <div class="form-group">
          <mat-form-field class="example-full-width">
            <mat-select placeholder="Indents" [(ngModel)]="newIndent" name="newIndent">
              <mat-option *ngFor="let destIndent of destIndentList" [value]="destIndent.INDENTNUMBER">
                {{destIndent.INDENTNUMBER}} - {{destIndent.NETBALANCE}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" mat-raised-button color="primary" (click)="setSelectedIndent(newIndent)">Submit</button>
      </div>
    </div>
  </div>
</div>